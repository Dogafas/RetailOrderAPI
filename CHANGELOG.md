# Changelog

Вся заметная история изменений в проекте `RetailOrderAPI` будет задокументирована в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/en/1.0.0/), 
и проект придерживается [Семантического Версионирования](https://semver.org/spec/v2.0.0.html).

## [1.0.0] - 2025-06-15

### Added (Добавлено)
- **Настройка проекта**: Инициализирован проект с использованием Docker, Docker Compose, Django, PostgreSQL, Celery, RabbitMQ и Redis.
- **Модели данных**: Спроектированы модели для пользователей (клиент, поставщик), товаров, заказов, корзины, контактов.
- **API аутентификации**: Реализована регистрация и аутентификация пользователей через `djoser` с кастомными сериализаторами.
- **API для поставщиков**:
  - Эндпоинт для управления статусом (вкл/выкл прием заказов).
  - Эндпоинт для асинхронной загрузки прайс-листа в формате YAML.
- **API для клиентов**:
  - Эндпоинт для просмотра каталога товаров с пагинацией, фильтрацией и поиском.
  - Эндпоинты для управления корзиной (добавление, изменение, удаление, просмотр).
  - Эндпоинты для управления контактными данными (адресами).
- **API для заказов**:
  - Эндпоинт для оформления заказа из корзины.
  - Асинхронная отправка email-уведомлений клиенту и администратору при создании заказа.
- **Уведомления о статусе**: Автоматическая отправка email клиенту при изменении статуса заказа в админ-панели (с помощью Django Signals).
- **Экспорт товаров**: Асинхронный экспорт каталога товаров в JSON.
- **Админ-панель**: Настроена админка Django для удобного управления заказами и локализована на русский язык.
- **Документация API**: Автоматическая генерация документации OpenAPI (Swagger/ReDoc) с помощью `drf-spectacular`.
- **Качество кода**: Настроены `black`, `isort`, `flake8` и `pre-commit` для поддержания единого стиля кода.

### Changed (Изменено)
- **Аутентификация**: Система аутентификации переведена со стандартной Token Authentication на JWT (`djangorestframework-simplejwt`) для повышения безопасности и производительности.
- **Пользовательская модель**: `User` расширена полем `user_type` для разделения ролей.
- **Импорт прайс-листа**: Логика импорта улучшена для поддержки `update_or_create` на основе внешнего ID товара, что делает процесс идемпотентным.
- **Права доступа**: Внедрены кастомные классы `Permission` (`IsClient`, `IsSupplier`, `IsAdminOrSupplier`) для более чистого и безопасного разграничения доступа к API.

### Fixed (Исправлено)
- **Циклические зависимости**: Устранены ошибки `ImportError`, вызванные циклическими зависимостями между модулями `views`, `tasks` и `serializers`.
- **Обработка ошибок API**: Улучшены сообщения об ошибках для более понятного ответа клиенту (например, при добавлении несуществующего товара в корзину).
- **Конфигурация Celery**: Улучшена конфигурация `docker-compose` с `healthcheck` для RabbitMQ, чтобы избежать ошибок `Connection refused` при старте.

### Removed (Удалено)
- **Token Authentication**: Удалена зависимость `rest_framework.authtoken` и связанные с ней URL-адреса.